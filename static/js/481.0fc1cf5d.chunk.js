"use strict";(self.webpackChunktfin_ui_project_template=self.webpackChunktfin_ui_project_template||[]).push([[481],{6481:function(e,n,t){t.r(n);var o=t(5861),r=t(1413),s=t(4925),i=t(5671),a=t(3144),l=t(9340),c=t(5716),p=t(7757),d=t.n(p),u=t(1694),h=t.n(u),C=t(2672),f=t(877),g=t(5154),v=t(2330),w=t(6202),x=t(6472),Z=t(2889),m=t(5996),S=t(4113),b=t(3170),y=t(8810),E=t(9306),k=t(2496),_=t(9468),W=t(9551),A=(t(2336),t(184)),P=["contextCls"],T=["contextCls"],L=["contextCls"],O=["isAgentOnline"],j=function(e){(0,l.Z)(p,e);var n=(0,c.Z)(p);function p(){var e;(0,i.Z)(this,p);for(var a=arguments.length,l=new Array(a),c=0;c<a;c++)l[c]=arguments[c];return(e=n.call.apply(n,[this].concat(l))).state={isLoading:!0,shouldShowChooseOptionWindow:!1,hasError:!1,shouldShowHoopWindow:!1,isI18nReady:!1},e.renderContent=function(){var n=e.state,t=n.shouldShowChooseOptionWindow,o=n.shouldShowHoopWindow,r=e.props.contextCls;return(0,A.jsxs)("div",{className:h()(e.baseCls,r),children:[t&&e.renderChooseOptionWindow(),o&&e.renderHoopWindow()]})},e.renderHoopWindow=function(){var n=e.props,t=(n.contextCls,(0,s.Z)(n,P)),o=e.state.chatConfigs,i=null!==o&&void 0!==o?o:{},a=i.hoop,l=i.isLeaveAgentMessageEnabled;return(0,A.jsx)(x.Z,(0,r.Z)((0,r.Z)({},t),{},{contextCls:"".concat(e.baseCls,"__hoop"),hoop:a,isLeaveAgentMessageEnabled:l},o))},e.renderChooseOptionWindow=function(){var n=e.props,t=(n.contextCls,(0,s.Z)(n,T)),o=e.state.chatConfigs,i=(null!==o&&void 0!==o?o:{}).ewt;return(0,A.jsx)(v.Z,(0,r.Z)((0,r.Z)({},t),{},{contextCls:"".concat(e.baseCls,"__choose-option-window"),ewt:i},o))},e.renderErrorPage=function(){var n=e.props,t=(n.contextCls,(0,s.Z)(n,L)),o=(0,f.i0)("chatModule.errorPage.title"),i=(0,f.i0)("chatModule.errorPage.headText"),a=(0,f.i0)("chatModule.errorPage.subText");return(0,A.jsx)(w.Z,(0,r.Z)((0,r.Z)({},t),{},{contextCls:"".concat(e.baseCls,"__generic-message"),icon:m.Z.WARNING,windowTitle:o,headText:i,subText:a}))},e.renderLoading=function(){var n=Object.assign({},e.props),t=(0,f.i0)("chatModule.loading.title");return(0,A.jsx)(Z.Z,(0,r.Z)((0,r.Z)({},n),{},{contextCls:"".concat(e.baseCls,"__loading"),title:t,shouldShowCloseBtn:!0}))},e.fetchConfig=(0,o.Z)(d().mark((function n(){var t,o,r,i;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t={isLoading:!1},n.prev=1,n.next=4,(0,b.$D)();case 4:o=n.sent,r=o.isAgentOnline,i=(0,s.Z)(o,O),t.chatConfigs=i,r?t.shouldShowChooseOptionWindow=!0:t.shouldShowHoopWindow=!0,n.next=13;break;case 10:n.prev=10,n.t0=n.catch(1),t.hasError=!0;case 13:return n.prev=13,e.setState(t),n.finish(13);case 16:case"end":return n.stop()}}),n,null,[[1,10,13,16]])}))),e.initialSetup=function(){var n=e.props,t=n.accessToken,o=n.applicationId,r=n.platform,s=n.env,i=n.brand;t&&(0,E.M8)(t),o&&(0,E.u0)(o),r&&(0,k.VY)(r.toUpperCase()),s&&((0,E.Nb)(s.toUpperCase()),W.Z.Environment=s.toUpperCase(),(0,E.S9)(_.G0[(0,k.Xf)()][(0,E.dU)()])),i&&(W.Z.Brand=i)},e.initI18n=(0,o.Z)(d().mark((function n(){return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,f.YV)({defaultTranslations:{"en-US":function(){return t.e(661).then(t.t.bind(t,6661,19))}},shouldLoadStrings:!1});case 2:e.setState({isI18nReady:!0});case 3:case"end":return n.stop()}}),n)}))),e.applyDesignToken=function(){var n=e.props.brand;(0,y.p)(n),e.setState({isDesignTokenApplied:!0})},e.setContainerElementStyle=function(){var n=e.props.containerElement;n&&(e.setState({originContainerElementPosition:n.style.position}),n.style.position="relative")},e.restoreContainerElementStyle=function(){var n=e.props.containerElement,t=e.state.originContainerElementPosition;n&&t&&(n.style.position=t)},e.destoryClient=(0,o.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.lu();case 2:case"end":return e.stop()}}),e)}))),e.baseCls="web-chat-module",e}return(0,a.Z)(p,[{key:"render",value:function(){var e=this.state,n=e.isDesignTokenApplied,t=e.isLoading,o=e.hasError,r=e.isI18nReady;return n&&r&&(0,A.jsx)(g.Z,{contextCls:"".concat(this.baseCls,"__loading"),isLoading:t,hasError:o,renderLoadingState:this.renderLoading,renderErrorState:this.renderErrorPage,children:this.renderContent()})}},{key:"componentDidMount",value:function(){this.initI18n(),this.initialSetup(),this.setContainerElementStyle(),this.fetchConfig(),this.applyDesignToken()}},{key:"componentWillUnmount",value:function(){this.restoreContainerElementStyle(),this.destoryClient(),(0,E.cG)()}}]),p}(C.PureComponent);j.defaultProps={onChatWidgetClose:function(){return Promise.resolve()},platform:_.iw.BAAS,brand:_.cg.GO2BANK,env:_.Gv.PROD},n.default=j}}]);
//# sourceMappingURL=481.0fc1cf5d.chunk.js.map